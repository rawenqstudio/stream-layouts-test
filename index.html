<!DOCTYPE html>
<html lang="pl">
  <head>
    <meta charset="UTF-8" />
    <title>StreamLayouts - Generator Pokoi</title>
    <style>
      body {
        font-family: "Segoe UI", sans-serif;
        background: #1a1a1a;
        color: white;
        text-align: center;
        padding-top: 50px;
        margin: 0;
      }
      .container {
        max-width: 600px;
        margin: 0 auto;
        background: #2a2a2a;
        padding: 40px;
        border-radius: 10px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
      }
      h1 {
        margin-bottom: 30px;
        color: #00d2ff;
      }

      .create-btn {
        background: linear-gradient(45deg, #00d2ff, #3a7bd5);
        border: none;
        padding: 15px 30px;
        color: white;
        font-size: 1.2em;
        border-radius: 30px;
        cursor: pointer;
        transition: transform 0.2s;
      }
      .create-btn:hover {
        transform: scale(1.05);
      }

      /* Flexbox dla ≈Çatwej zmiany kolejno≈õci */
      #links-area {
        display: none;
        margin-top: 30px;
        text-align: left;
        flex-direction: column;
      }

      .link-group {
        margin-bottom: 20px;
        background: #333;
        padding: 15px;
        border-radius: 8px;
      }
      .link-group label {
        display: block;
        color: #aaa;
        font-size: 0.9em;
        margin-bottom: 5px;
        font-weight: bold;
      }
      .link-group input {
        width: 95%;
        padding: 10px;
        background: #111;
        border: 1px solid #444;
        color: #fff;
        border-radius: 5px;
        display: block;
        margin-bottom: 10px;
      }

      .action-btn {
        font-size: 0.9em;
        padding: 8px 15px;
        border: none;
        color: white;
        cursor: pointer;
        border-radius: 3px;
        margin-right: 5px;
        transition: 0.2s;
      }
      .copy-btn {
        background: #555;
      }
      .copy-btn:hover {
        background: #777;
      }
      .open-btn {
        background: #28a745;
      }
      .open-btn:hover {
        background: #218838;
      }

      .option-box {
        margin: 10px 0;
        padding: 10px;
        border: 1px dashed #555;
        border-radius: 5px;
        display: block;
        text-align: left;
      }
      .checkbox-label {
        cursor: pointer;
        color: #ddd;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .footer-credits {
        position: fixed;
        bottom: 15px;
        right: 20px;
        color: #666;
        font-size: 0.85em;
        font-family: monospace;
        user-select: none;
        pointer-events: none;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üé• Stream Layout Generator</h1>
      <p>Stw√≥rz pok√≥j, wy≈õlij linki i steruj uk≈Çadem kamer w OBS.</p>

      <div class="option-box">
        <label class="checkbox-label">
          <input
            type="checkbox"
            id="stun-only"
            style="width: 20px; height: 20px"
            checked
          />
          <div>
            <strong>üöÄ Tryb Turbo (STUN Only)</strong><br />
            <small style="color: #888"
              >Ni≈ºsze op√≥≈∫nienie (P2P), ale mo≈ºe nie dzia≈Çaƒá na LTE.</small
            >
          </div>
        </label>
      </div>

      <div class="option-box" style="border-color: #d63384">
        <label class="checkbox-label">
          <input
            type="checkbox"
            id="ull-mode"
            style="width: 20px; height: 20px"
            checked
          />
          <div>
            <strong>‚ö° Ultra Low Latency (Brak bufora)</strong><br />
            <small style="color: #888">Wy≈ÇƒÖcza wyg≈Çadzanie ruchu w OBS.</small>
          </div>
        </label>
      </div>

      <div class="option-box" style="border-color: #ff9800">
        <label class="checkbox-label">
          <!-- DOMY≈öLNIE ZAZNACZONE (CHECKED) -->
          <input
            type="checkbox"
            id="multi-mode"
            style="width: 20px; height: 20px"
            checked
          />
          <div>
            <strong>üë• Multi-Viewer Mode (Wiele OBS-√≥w)</strong><br />
            <small style="color: #888"
              >Wymaga uruchomienia Re≈ºysera jako pierwszego. Wymaga dobrego
              ≈ÇƒÖcza.</small
            >
          </div>
        </label>
      </div>
      <br />

      <button class="create-btn" onclick="createRoom()">
        + Stw√≥rz Nowy Pok√≥j
      </button>

      <div id="links-area">
        <!-- GRUPA 1: OBS (Kolejno≈õƒá zmieniana przez JS) -->
        <div class="link-group" id="group-obs">
          <label id="label-obs">Link do OBS:</label>
          <input type="text" id="obs-link" readonly />
          <button class="action-btn copy-btn" onclick="copy('obs-link')">
            üìã Kopiuj
          </button>
          <!-- DODANO PRZYCISK OTW√ìRZ: -->
          <button class="action-btn open-btn" onclick="openLink('obs-link')">
            ‚Üó Otw√≥rz
          </button>
        </div>

        <!-- GRUPA 2: RE≈ªYSER (Kolejno≈õƒá zmieniana przez JS) -->
        <div class="link-group" id="group-dir">
          <label id="label-dir">Panel Re≈ºysera:</label>
          <input type="text" id="director-link" readonly />
          <button class="action-btn copy-btn" onclick="copy('director-link')">
            üìã Kopiuj
          </button>
          <button
            class="action-btn open-btn"
            onclick="openLink('director-link')"
          >
            ‚Üó Otw√≥rz
          </button>
        </div>

        <!-- GRUPA 3: GO≈öƒÜ -->
        <div class="link-group" id="group-guest" style="order: 3">
          <label id="label-guest">3. Link dla Go≈õci (Wy≈õlij znajomym):</label>
          <input type="text" id="guest-link" readonly />
          <button class="action-btn copy-btn" onclick="copy('guest-link')">
            üìã Kopiuj
          </button>
          <button class="action-btn open-btn" onclick="openLink('guest-link')">
            ‚Üó Otw√≥rz
          </button>
        </div>
      </div>
    </div>

    <div class="footer-credits">from xrawenq for Goodiez</div>

    <script>
      function createRoom() {
        const roomId = Math.random().toString(36).substring(2, 9);

        const isStunOnly = document.getElementById("stun-only").checked;
        const isULL = document.getElementById("ull-mode").checked;
        const isMulti = document.getElementById("multi-mode").checked;

        let params = `?room=${roomId}`;
        if (isStunOnly) params += "&stunonly=1";
        if (isULL) params += "&ull=1";
        if (isMulti) params += "&multi=1";

        let baseUrl = window.location.href;
        if (baseUrl.endsWith("index.html"))
          baseUrl = baseUrl.replace("index.html", "");
        if (!baseUrl.endsWith("/")) baseUrl += "/";

        const obsUrl = `${baseUrl}obs.html${params}`;
        const directorUrl = `${baseUrl}director.html${params}`;
        const guestUrl = `${baseUrl}guest.html${params}`;

        document.getElementById("obs-link").value = obsUrl;
        document.getElementById("director-link").value = directorUrl;
        document.getElementById("guest-link").value = guestUrl;

        // --- ZMIANA KOLEJNO≈öCI I ETYKIET W ZALE≈ªNO≈öCI OD TRYBU ---
        const groupObs = document.getElementById("group-obs");
        const groupDir = document.getElementById("group-dir");
        const labelObs = document.getElementById("label-obs");
        const labelDir = document.getElementById("label-dir");

        if (isMulti) {
          // Tryb Multi: Re≈ºyser jest najwa≈ºniejszy (nr 1)
          groupDir.style.order = "1";
          groupObs.style.order = "2";

          labelDir.innerHTML = "1. Panel Re≈ºysera (‚ö†Ô∏è URUCHOM JAKO PIERWSZY):";
          labelObs.innerHTML = "2. Link do OBS (Odbiornik):";

          // Stylizuj label re≈ºysera na czerwono/wyra≈∫nie
          labelDir.style.color = "#ff9800";
        } else {
          // Tryb Standard: OBS jest serwerem (nr 1)
          groupObs.style.order = "1";
          groupDir.style.order = "2";

          labelObs.innerHTML = "1. Link do OBS (Wklej jako Browser Source):";
          labelDir.innerHTML = "2. Panel Re≈ºysera (Sterowanie):";

          labelDir.style.color = "#aaa"; // Reset koloru
        }

        document.getElementById("links-area").style.display = "flex";
      }

      function copy(elementId) {
        const copyText = document.getElementById(elementId);
        copyText.select();
        document.execCommand("copy");
      }

      function openLink(elementId) {
        const url = document.getElementById(elementId).value;
        if (url) window.open(url, "_blank");
        else alert("Najpierw wygeneruj pok√≥j!");
      }
    </script>
  </body>
</html>
